<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "News Aggregator App" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

     <!-- Carregando o SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.0/dist/sweetalert2.min.css">

    <!-- Carregando o SweetAlert2 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.3.0/dist/sweetalert2.min.js"></script>

     <!-- Flowbite CSS -->
    <link href="https://cdn.jsdelivr.net/npm/flowbite@1.5.1/dist/flowbite.min.css" rel="stylesheet">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <header class="bg-white p-4 shadow-lg border-b border-gray-200">
      <nav class="">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
          
          <div class="text-gray-800 font-semibold text-xl">
            <%= link_to "News Aggregator", root_path, class: "hover:text-gray-500 transition-colors" %>
          </div>

          <!-- Ícone de Hambúrguer para dispositivos móveis -->
          <button data-collapse-toggle="navbar-solid-bg" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-solid-bg" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
            </svg>
          </button>

          <!-- Menu de Navegação em Dispositivos Grandes -->
          <div class="hidden w-full md:block md:w-auto" id="navbar-solid-bg">
            <ul class="flex flex-col font-medium mt-4 rounded-lg md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-transparent">
              <% if user_signed_in? %>

                <li>
                  <% if controller_name == "registrations" && action_name == "edit" %>
                    <%= link_to "← Back to Search", search_news_index_path, class: "block py-2 px-3 text-gray-800 dark:text-white hover:opacity-25 hover:text-gray-500 cursor-pointer" %>
                  <% elsif controller_name == "news" && action_name == "search" %>
                    <%= link_to "Edit Profile", edit_user_registration_path, class: "block py-2 px-3 text-gray-800 dark:text-white hover:opacity-25 hover:text-gray-500 cursor-pointer" %>
                  <% end %>
                </li>

                <li>

                  <% if controller_name == "news" && action_name == "search" %>
                    <%= link_to "Saved Articles", read_later_news_index_path, class: "block py-2 px-3 text-gray-800 dark:text-white hover:opacity-25 hover:text-gray-500 cursor-pointer" %>
                  <% elsif controller_name == "news" && action_name == "read_later" %>     
                    <%= link_to "← Back to Search", search_news_index_path, class: "block py-2 px-3 text-gray-800 dark:text-white hover:opacity-25 hover:text-gray-500 cursor-pointer" %>   
                  <% end %>

                </li>

                <li>
                  <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "block py-2 px-3 text-gray-800 dark:text-white hover:opacity-25 hover:text-gray-500 cursor-pointer" %>
                </li>
              <% end %>
            </ul>
          </div>

        </div>

        <!-- Menu de Navegação em Dispositivos Móveis -->
        <div id="mobile-menu" class="sm:hidden hidden flex-col absolute top-0 left-0 w-full bg-white shadow-lg border-t border-gray-200 z-10">
          <ul class="flex flex-col font-medium mt-4 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-transparent dark:bg-gray-800 md:dark:bg-transparent dark:border-gray-700">
            <% if user_signed_in? %>

              <li>
                <% if controller_name == "registrations" && action_name == "edit" %>
                  <%= link_to "← Back to Search", search_news_index_path, class: "block py-2 px-3 text-gray-800 dark:text-white" %>
                <% elsif controller_name == "news" && action_name == "search" %>
                  <%= link_to "Edit Profile", edit_user_registration_path, class: "block py-2 px-3 text-gray-800 dark:text-white" %>
                <% end %>
              </li>

              <li>
                <% if controller_name == "news" && action_name == "search" %>
                  <%= link_to "Saved Articles", read_later_news_index_path, class: "block py-2 px-3 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700" %>
                <% elsif controller_name == "news" && action_name == "read_later" %>     
                  <%= link_to "← Back to Search", search_news_index_path, class: "block py-2 px-3 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700" %>   
                <% end %>
              </li>

              <li>
                <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "block py-2 px-3 text-gray-900 hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700" %>
              </li>
            <% end %>
          </ul>
        </div>
      </nav>
    </header>
    
    <% if flash[:notice] %>
      <script>
        Swal.fire({
          toast: true,
          position: 'bottom-end',
          icon: 'success',
          title: "<%= flash[:notice] %>",
          showConfirmButton: false,
          timer: 3000,
        });
      </script>
    <% end %>
    <% if flash[:alert] %>
      <script>
        Swal.fire({
          toast: true,
          position: 'bottom-end',
          icon: 'error',
          title: "<%= flash[:alert] %>",
          showConfirmButton: false,
          timer: 3000,
        });
      </script>
    <% end %>
    
      <!-- Flowbite JS -->
    <script src="https://cdn.jsdelivr.net/npm/flowbite@1.5.1/dist/flowbite.min.js"></script>

    <!-- Alpine.js, necessário para interação do Flowbite -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js" defer></script>

    <main class="container mx-auto mt-28 p-6 flex justify-center items-center">
      <%= yield %>
    </main>
    
  </body>
</html>


